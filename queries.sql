select members.name as "Player", avg(attacks.destruction) as "Avg Destruction", count(attacks.destruction) as "Number of attacks" from attacks inner join members on members.id = attacks.attacker group by attacks.attacker order by avg(attacks.destruction) desc
select members.name as "Player", avg(defence.destruction) as "Avg Destruction", count(defence.destruction) as "Number of defences" from defence inner join members on members.id = defence.defender group by defence.defender order by avg(defence.destruction) asc
select members.name as "Player", avg(attacks.destruction) as "Avg Destruction", count(attacks.destruction) as "Number of attacks" from attacks inner join members on members.id = attacks.attacker where members.id in (select members.id from attacks inner join members on members.id = attacks.attacker inner join war on attacks.war_id = war.war_id  where war.start_date >= "20210328" group by members.id) group by attacks.attacker order by avg(attacks.destruction) desc
